<div class="container mt-5 mb-5">
    <h1 class="text-center">Snack List</h1>
  
    <div *ngIf="loading" class="loading-container">
      <div class="spinner-border" role="status">
        <span class="visually-hidden">Loading...</span>
      </div>
      <p class="mt-3">Loading requests...</p>
    </div>
  
    <div *ngIf="error" class="alert alert-danger" role="alert">
      <strong>Error:</strong> {{ error }}
    </div>
  
    <div class="table-container" *ngIf="!loading && !error">
    <!-- Desktop Table View -->
    <table class="table table-striped">
      <thead>
        <tr>
          <th>Status</th>
          <th>Name</th>
          <th>Snack</th>
          <th>Drink</th>
          <th>Misc</th>
          <th>Link</th>
          <th>Date Requested</th>
          <th>Date Ordered</th> 
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let request of snackRequests" [class.ordered-row]="request.ordered_flag === 1">
          <td>
            <span *ngIf="request.ordered_flag === 1" class="badge bg-success" title="Your snack has been ordered!">
              âœ“ Ordered
            </span>
            <span *ngIf="request.ordered_flag === 0" class="badge bg-warning text-dark">
              â³ Pending
            </span>
          </td>
          <td>{{ request.user_name }}</td>
          <td>{{ request.snack }}</td>
          <td>{{ request.drink }}</td>
          <td>{{ request.misc }}</td>
          <td><a *ngIf="request.link" href="{{ request.link }}" target="_blank" rel="noopener noreferrer">
               View Link 
             </a></td>
          <td>{{ request.created_at | date:'shortDate' }}</td>
          <td>
            <span *ngIf="request.ordered_at">
              {{ request.ordered_at | date:'shortDate' }}
              <span class="text-success ms-1" *ngIf="request.ordered_flag === 1">ğŸ‰</span>
            </span>
            <span *ngIf="!request.ordered_at" class="text-muted">â€”</span>
          </td> 
        </tr>
      </tbody>
    </table>

    <!-- Mobile Card View -->
    <div class="mobile-card-view">
      <div *ngFor="let request of snackRequests" 
           class="request-card" 
           [class.ordered]="request.ordered_flag === 1">
        <div class="card-header">
          <span class="card-title">{{ request.user_name }}</span>
          <span *ngIf="request.ordered_flag === 1" class="badge bg-success">
            âœ“ Ordered
          </span>
          <span *ngIf="request.ordered_flag === 0" class="badge bg-warning text-dark">
            â³ Pending
          </span>
        </div>
        <div class="card-row" *ngIf="request.snack">
          <span class="card-label">Snack:</span>
          <span class="card-value">{{ request.snack }}</span>
        </div>
        <div class="card-row" *ngIf="request.drink">
          <span class="card-label">Drink:</span>
          <span class="card-value">{{ request.drink }}</span>
        </div>
        <div class="card-row" *ngIf="request.misc">
          <span class="card-label">Misc:</span>
          <span class="card-value">{{ request.misc }}</span>
        </div>
        <div class="card-row" *ngIf="request.link">
          <span class="card-label">Link:</span>
          <span class="card-value">
            <a [href]="request.link" target="_blank" rel="noopener noreferrer">View Link</a>
          </span>
        </div>
        <div class="card-row">
          <span class="card-label">Requested:</span>
          <span class="card-value">{{ request.created_at | date:'shortDate' }}</span>
        </div>
        <div class="card-row" *ngIf="request.ordered_at">
          <span class="card-label">Ordered:</span>
          <span class="card-value">
            {{ request.ordered_at | date:'shortDate' }}
            <span *ngIf="request.ordered_flag === 1">ğŸ‰</span>
          </span>
        </div>
      </div>
    </div>

    <p class="text-center" *ngIf="snackRequests.length === 0">No snack requests found.</p>
    </div>
  </div>